"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/licenses";
exports.ids = ["pages/api/licenses"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = import("uuid");;

/***/ }),

/***/ "(api)/__barrel_optimize__?names=addMonths,addYears!=!./node_modules/date-fns/index.mjs":
/*!****************************************************************************************!*\
  !*** __barrel_optimize__?names=addMonths,addYears!=!./node_modules/date-fns/index.mjs ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addMonths: () => (/* reexport safe */ C_Users_NguyenHuy_Desktop_Ban_tool_license_system_node_modules_date_fns_addMonths_mjs__WEBPACK_IMPORTED_MODULE_0__.addMonths),\n/* harmony export */   addYears: () => (/* reexport safe */ C_Users_NguyenHuy_Desktop_Ban_tool_license_system_node_modules_date_fns_addYears_mjs__WEBPACK_IMPORTED_MODULE_1__.addYears)\n/* harmony export */ });\n/* harmony import */ var C_Users_NguyenHuy_Desktop_Ban_tool_license_system_node_modules_date_fns_addMonths_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/date-fns/addMonths.mjs */ \"(api)/./node_modules/date-fns/addMonths.mjs\");\n/* harmony import */ var C_Users_NguyenHuy_Desktop_Ban_tool_license_system_node_modules_date_fns_addYears_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./node_modules/date-fns/addYears.mjs */ \"(api)/./node_modules/date-fns/addYears.mjs\");\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvX19iYXJyZWxfb3B0aW1pemVfXz9uYW1lcz1hZGRNb250aHMsYWRkWWVhcnMhPSEuL25vZGVfbW9kdWxlcy9kYXRlLWZucy9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFDMEgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9saWNlbnNlLXN5c3RlbS8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9pbmRleC5tanM/NWMyMSJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCB7IGFkZE1vbnRocyB9IGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxOZ3V5ZW5IdXlcXFxcRGVza3RvcFxcXFxCYW4gdG9vbFxcXFxsaWNlbnNlLXN5c3RlbVxcXFxub2RlX21vZHVsZXNcXFxcZGF0ZS1mbnNcXFxcYWRkTW9udGhzLm1qc1wiXG5leHBvcnQgeyBhZGRZZWFycyB9IGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxOZ3V5ZW5IdXlcXFxcRGVza3RvcFxcXFxCYW4gdG9vbFxcXFxsaWNlbnNlLXN5c3RlbVxcXFxub2RlX21vZHVsZXNcXFxcZGF0ZS1mbnNcXFxcYWRkWWVhcnMubWpzXCIiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/__barrel_optimize__?names=addMonths,addYears!=!./node_modules/date-fns/index.mjs\n");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Flicenses&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Clicenses%5Cindex.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Flicenses&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Clicenses%5Cindex.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_licenses_index_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\licenses\\index.ts */ \"(api)/./pages/api/licenses/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_licenses_index_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_licenses_index_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_licenses_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_licenses_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/licenses\",\n        pathname: \"/api/licenses\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_licenses_index_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmxpY2Vuc2VzJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNsaWNlbnNlcyU1Q2luZGV4LnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzZEO0FBQzdEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx5REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMseURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGljZW5zZS1zeXN0ZW0vPzg1NWYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxsaWNlbnNlc1xcXFxpbmRleC50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2xpY2Vuc2VzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbGljZW5zZXNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Flicenses&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Clicenses%5Cindex.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/prisma.ts":
/*!***********************!*\
  !*** ./lib/prisma.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nlet prisma;\nif (false) {} else {\n    // In development, use a global variable to prevent multiple instances\n    if (!global.prisma) {\n        global.prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n    }\n    prisma = global.prisma;\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQUU5QyxJQUFJQztBQUVKLElBQUlDLEtBQXlCLEVBQWMsRUFFMUMsTUFBTTtJQUNMLHNFQUFzRTtJQUN0RSxJQUFJLENBQUMsT0FBZ0JELE1BQU0sRUFBRTtRQUMxQkUsT0FBZUYsTUFBTSxHQUFHLElBQUlELHdEQUFZQTtJQUMzQztJQUNBQyxTQUFTLE9BQWdCQSxNQUFNO0FBQ2pDO0FBRWtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGljZW5zZS1zeXN0ZW0vLi9saWIvcHJpc21hLnRzPzk4MjIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xyXG5cclxubGV0IHByaXNtYTogUHJpc21hQ2xpZW50O1xyXG5cclxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcclxuICBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XHJcbn0gZWxzZSB7XHJcbiAgLy8gSW4gZGV2ZWxvcG1lbnQsIHVzZSBhIGdsb2JhbCB2YXJpYWJsZSB0byBwcmV2ZW50IG11bHRpcGxlIGluc3RhbmNlc1xyXG4gIGlmICghKGdsb2JhbCBhcyBhbnkpLnByaXNtYSkge1xyXG4gICAgKGdsb2JhbCBhcyBhbnkpLnByaXNtYSA9IG5ldyBQcmlzbWFDbGllbnQoKTtcclxuICB9XHJcbiAgcHJpc21hID0gKGdsb2JhbCBhcyBhbnkpLnByaXNtYTtcclxufVxyXG5cclxuZXhwb3J0IHsgcHJpc21hIH07ICJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJwcm9jZXNzIiwiZ2xvYmFsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/prisma.ts\n");

/***/ }),

/***/ "(api)/./pages/api/licenses/index.ts":
/*!*************************************!*\
  !*** ./pages/api/licenses/index.ts ***!
  \*************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var _barrel_optimize_names_addMonths_addYears_date_fns__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! __barrel_optimize__?names=addMonths,addYears!=!date-fns */ \"(api)/__barrel_optimize__?names=addMonths,addYears!=!./node_modules/date-fns/index.mjs\");\n/* harmony import */ var _utils_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/auth */ \"(api)/./utils/auth.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([uuid__WEBPACK_IMPORTED_MODULE_1__]);\nuuid__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\nconst prismaClient = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nasync function handler(req, res) {\n    if (req.method === \"GET\") {\n        try {\n            // Kiểm tra quyền admin\n            const admin = await (0,_utils_auth__WEBPACK_IMPORTED_MODULE_2__.requireAdmin)(req, res);\n            if (!admin) {\n                return res.status(403).json({\n                    error: \"Kh\\xf4ng c\\xf3 quyền truy cập\"\n                });\n            }\n            // Lấy danh sách license\n            const licenses = await prismaClient.license.findMany({\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            email: true,\n                            name: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return res.status(200).json({\n                licenses\n            });\n        } catch (error) {\n            console.error(\"Get licenses error:\", error);\n            return res.status(500).json({\n                error: \"Lỗi khi lấy danh s\\xe1ch license\"\n            });\n        }\n    } else if (req.method === \"POST\") {\n        try {\n            const { type, email, name } = req.body;\n            if (!type || !email) {\n                return res.status(400).json({\n                    error: \"Type and email are required\"\n                });\n            }\n            // Tìm user theo email\n            let user = await prismaClient.user.findUnique({\n                where: {\n                    email\n                }\n            });\n            // Nếu không tìm thấy user, tạo mới\n            if (!user) {\n                user = await prismaClient.user.create({\n                    data: {\n                        email,\n                        name: name || email,\n                        password: \"default_password\",\n                        role: \"USER\"\n                    }\n                });\n            }\n            // Tạo license mới\n            const license = await prismaClient.license.create({\n                data: {\n                    key: (0,uuid__WEBPACK_IMPORTED_MODULE_1__.v4)(),\n                    type,\n                    status: \"UNACTIVATED\",\n                    userId: user.id,\n                    expiresAt: calculateExpirationDate(type)\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            email: true,\n                            name: true\n                        }\n                    }\n                }\n            });\n            return res.status(201).json({\n                success: true,\n                data: license\n            });\n        } catch (error) {\n            console.error(\"Create license error:\", error);\n            return res.status(500).json({\n                error: \"Lỗi server\"\n            });\n        }\n    } else {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n}\n// Hàm tính ngày hết hạn\nfunction calculateExpirationDate(type) {\n    const now = new Date();\n    switch(type){\n        case \"ONE_MONTH\":\n            return (0,_barrel_optimize_names_addMonths_addYears_date_fns__WEBPACK_IMPORTED_MODULE_3__.addMonths)(now, 1);\n        case \"THREE_MONTHS\":\n            return (0,_barrel_optimize_names_addMonths_addYears_date_fns__WEBPACK_IMPORTED_MODULE_3__.addMonths)(now, 3);\n        case \"SIX_MONTHS\":\n            return (0,_barrel_optimize_names_addMonths_addYears_date_fns__WEBPACK_IMPORTED_MODULE_3__.addMonths)(now, 6);\n        case \"ONE_YEAR\":\n            return (0,_barrel_optimize_names_addMonths_addYears_date_fns__WEBPACK_IMPORTED_MODULE_3__.addYears)(now, 1);\n        default:\n            throw new Error(\"Invalid license type\");\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aEIsT0FBUWQ7UUFDTixLQUFLO1lBQ0gsT0FBT3hCLDZGQUFTQSxDQUFDcUMsS0FBSztRQUN4QixLQUFLO1lBQ0gsT0FBT3JDLDZGQUFTQSxDQUFDcUMsS0FBSztRQUN4QixLQUFLO1lBQ0gsT0FBT3JDLDZGQUFTQSxDQUFDcUMsS0FBSztRQUN4QixLQUFLO1lBQ0gsT0FBT3BDLDRGQUFRQSxDQUFDb0MsS0FBSztRQUN2QjtZQUNFLE1BQU0sSUFBSUUsTUFBTTtJQUNwQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGljZW5zZS1zeXN0ZW0vLi9wYWdlcy9hcGkvbGljZW5zZXMvaW5kZXgudHM/NTg5NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XHJcbmltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcclxuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XHJcbmltcG9ydCB7IGFkZE1vbnRocywgYWRkWWVhcnMgfSBmcm9tICdkYXRlLWZucyc7XHJcbmltcG9ydCB7IGF1dGhlbnRpY2F0ZVVzZXIsIHJlcXVpcmVBZG1pbiB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2F1dGgnO1xyXG5pbXBvcnQgcHJpc21hIGZyb20gJy4uLy4uLy4uL3V0aWxzL3ByaXNtYSc7XHJcblxyXG5jb25zdCBwcmlzbWFDbGllbnQgPSBuZXcgUHJpc21hQ2xpZW50KCk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XHJcbiAgaWYgKHJlcS5tZXRob2QgPT09ICdHRVQnKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBLaeG7g20gdHJhIHF1eeG7gW4gYWRtaW5cclxuICAgICAgY29uc3QgYWRtaW4gPSBhd2FpdCByZXF1aXJlQWRtaW4ocmVxLCByZXMpO1xyXG4gICAgICBpZiAoIWFkbWluKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgZXJyb3I6ICdLaMO0bmcgY8OzIHF1eeG7gW4gdHJ1eSBj4bqtcCcgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEzhuqV5IGRhbmggc8OhY2ggbGljZW5zZVxyXG4gICAgICBjb25zdCBsaWNlbnNlcyA9IGF3YWl0IHByaXNtYUNsaWVudC5saWNlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICB1c2VyOiB7XHJcbiAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgIGlkOiB0cnVlLFxyXG4gICAgICAgICAgICAgIGVtYWlsOiB0cnVlLFxyXG4gICAgICAgICAgICAgIG5hbWU6IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb3JkZXJCeToge1xyXG4gICAgICAgICAgY3JlYXRlZEF0OiAnZGVzYydcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbGljZW5zZXMgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdHZXQgbGljZW5zZXMgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0zhu5dpIGtoaSBs4bqleSBkYW5oIHPDoWNoIGxpY2Vuc2UnIH0pO1xyXG4gICAgfVxyXG4gIH0gZWxzZSBpZiAocmVxLm1ldGhvZCA9PT0gJ1BPU1QnKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IHR5cGUsIGVtYWlsLCBuYW1lIH0gPSByZXEuYm9keTtcclxuICAgICAgXHJcbiAgICAgIGlmICghdHlwZSB8fCAhZW1haWwpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1R5cGUgYW5kIGVtYWlsIGFyZSByZXF1aXJlZCcgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFTDrG0gdXNlciB0aGVvIGVtYWlsXHJcbiAgICAgIGxldCB1c2VyID0gYXdhaXQgcHJpc21hQ2xpZW50LnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgZW1haWwgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIE7hur91IGtow7RuZyB0w6xtIHRo4bqleSB1c2VyLCB04bqhbyBt4bubaVxyXG4gICAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICB1c2VyID0gYXdhaXQgcHJpc21hQ2xpZW50LnVzZXIuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgZW1haWwsXHJcbiAgICAgICAgICAgIG5hbWU6IG5hbWUgfHwgZW1haWwsXHJcbiAgICAgICAgICAgIHBhc3N3b3JkOiAnZGVmYXVsdF9wYXNzd29yZCcsXHJcbiAgICAgICAgICAgIHJvbGU6ICdVU0VSJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBU4bqhbyBsaWNlbnNlIG3hu5tpXHJcbiAgICAgIGNvbnN0IGxpY2Vuc2UgPSBhd2FpdCBwcmlzbWFDbGllbnQubGljZW5zZS5jcmVhdGUoe1xyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIGtleTogdXVpZHY0KCksXHJcbiAgICAgICAgICB0eXBlLFxyXG4gICAgICAgICAgc3RhdHVzOiAnVU5BQ1RJVkFURUQnLFxyXG4gICAgICAgICAgdXNlcklkOiB1c2VyLmlkLFxyXG4gICAgICAgICAgZXhwaXJlc0F0OiBjYWxjdWxhdGVFeHBpcmF0aW9uRGF0ZSh0eXBlKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgdXNlcjoge1xyXG4gICAgICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgICAgICBpZDogdHJ1ZSxcclxuICAgICAgICAgICAgICBlbWFpbDogdHJ1ZSxcclxuICAgICAgICAgICAgICBuYW1lOiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogbGljZW5zZSB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NyZWF0ZSBsaWNlbnNlIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdM4buXaSBzZXJ2ZXInIH0pO1xyXG4gICAgfVxyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBIw6BtIHTDrW5oIG5nw6B5IGjhur90IGjhuqFuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZUV4cGlyYXRpb25EYXRlKHR5cGU6IHN0cmluZyk6IERhdGUge1xyXG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICBjYXNlICdPTkVfTU9OVEgnOlxyXG4gICAgICByZXR1cm4gYWRkTW9udGhzKG5vdywgMSk7XHJcbiAgICBjYXNlICdUSFJFRV9NT05USFMnOlxyXG4gICAgICByZXR1cm4gYWRkTW9udGhzKG5vdywgMyk7XHJcbiAgICBjYXNlICdTSVhfTU9OVEhTJzpcclxuICAgICAgcmV0dXJuIGFkZE1vbnRocyhub3csIDYpO1xyXG4gICAgY2FzZSAnT05FX1lFQVInOlxyXG4gICAgICByZXR1cm4gYWRkWWVhcnMobm93LCAxKTtcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBsaWNlbnNlIHR5cGUnKTtcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsInY0IiwidXVpZHY0IiwiYWRkTW9udGhzIiwiYWRkWWVhcnMiLCJyZXF1aXJlQWRtaW4iLCJwcmlzbWFDbGllbnQiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwiYWRtaW4iLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJsaWNlbnNlcyIsImxpY2Vuc2UiLCJmaW5kTWFueSIsImluY2x1ZGUiLCJ1c2VyIiwic2VsZWN0IiwiaWQiLCJlbWFpbCIsIm5hbWUiLCJvcmRlckJ5IiwiY3JlYXRlZEF0IiwiY29uc29sZSIsInR5cGUiLCJib2R5IiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiY3JlYXRlIiwiZGF0YSIsInBhc3N3b3JkIiwicm9sZSIsImtleSIsInVzZXJJZCIsImV4cGlyZXNBdCIsImNhbGN1bGF0ZUV4cGlyYXRpb25EYXRlIiwic3VjY2VzcyIsIm5vdyIsIkRhdGUiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/licenses/index.ts\n");

/***/ }),

/***/ "(api)/./utils/auth.ts":
/*!***********************!*\
  !*** ./utils/auth.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authenticateUser: () => (/* binding */ authenticateUser),\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   logout: () => (/* binding */ logout),\n/* harmony export */   requireAdmin: () => (/* binding */ requireAdmin),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword),\n/* harmony export */   verifyToken: () => (/* binding */ verifyToken)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcrypt__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/prisma */ \"(api)/./lib/prisma.ts\");\n\n\n\n// Đảm bảo JWT_SECRET được cấu hình\nif (!process.env.JWT_SECRET) {\n    throw new Error(\"JWT_SECRET is not configured in environment variables\");\n}\nconst JWT_SECRET = process.env.JWT_SECRET;\n// Hàm tạo JWT token\nconst generateToken = (userId)=>{\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign({\n        userId\n    }, JWT_SECRET, {\n        expiresIn: \"30d\"\n    });\n};\n// Mã hóa mật khẩu với bcrypt\nconst hashPassword = async (password)=>{\n    const hashedPassword = await (0,bcrypt__WEBPACK_IMPORTED_MODULE_1__.hash)(password, 10);\n    return hashedPassword;\n};\n// Kiểm tra mật khẩu\nconst verifyPassword = async (plainPassword, hashedPassword)=>{\n    try {\n        const isValid = await (0,bcrypt__WEBPACK_IMPORTED_MODULE_1__.compare)(plainPassword, hashedPassword);\n        return isValid;\n    } catch (error) {\n        console.error(\"Error verifying password:\", error);\n        return false;\n    }\n};\n// Xác thực token\nconst verifyToken = async (token)=>{\n    try {\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, JWT_SECRET);\n        return decoded;\n    } catch (error) {\n        console.error(\"Token verification error:\", error);\n        return null;\n    }\n};\n// Xác thực user\nasync function authenticateUser(req, res) {\n    try {\n        // Parse cookies từ header\n        const cookies = req.headers.cookie?.split(\";\").reduce((acc, cookie)=>{\n            const [key, value] = cookie.trim().split(\"=\");\n            acc[key] = value;\n            return acc;\n        }, {});\n        const token = cookies?.token;\n        if (!token) {\n            return null;\n        }\n        // Verify token\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__.verify)(token, JWT_SECRET);\n        if (!decoded || !decoded.userId) {\n            return null;\n        }\n        // Tìm user trong database\n        const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.user.findUnique({\n            where: {\n                id: decoded.userId\n            },\n            select: {\n                id: true,\n                email: true,\n                name: true,\n                role: true\n            }\n        });\n        if (!user) {\n            return null;\n        }\n        return user;\n    } catch (error) {\n        console.error(\"Authentication error:\", error);\n        return null;\n    }\n}\nconst requireAuth = async (req, res)=>{\n    const user = await authenticateUser(req, res);\n    if (!user) {\n        res.status(401).json({\n            error: \"Unauthorized\"\n        });\n        return null;\n    }\n    return user;\n};\n// Middleware kiểm tra quyền admin\nasync function requireAdmin(req, res) {\n    const user = await authenticateUser(req, res);\n    if (!user) {\n        res.status(401).json({\n            error: \"Unauthorized\"\n        });\n        return null;\n    }\n    if (user.role !== \"ADMIN\") {\n        res.status(403).json({\n            error: \"Forbidden\"\n        });\n        return null;\n    }\n    return user;\n}\n// Tạo session mới\nconst createSession = async (userId)=>{\n    const token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign({\n        userId\n    }, JWT_SECRET, {\n        expiresIn: \"30d\"\n    });\n    const session = await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.session.create({\n        data: {\n            userId,\n            token,\n            expiresAt: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)\n        }\n    });\n    return session;\n};\n// Hàm đăng xuất (xóa session)\nconst logout = async (token)=>{\n    await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.session.deleteMany({\n        where: {\n            token\n        }\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VSxNQUFNO1FBQ1RWLElBQUltQixNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUUzQixPQUFPO1FBQWU7UUFDN0MsT0FBTztJQUNUO0lBRUEsSUFBSWlCLEtBQUtPLElBQUksS0FBSyxTQUFTO1FBQ3pCakIsSUFBSW1CLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRTNCLE9BQU87UUFBWTtRQUMxQyxPQUFPO0lBQ1Q7SUFFQSxPQUFPaUI7QUFDVDtBQUVBLGtCQUFrQjtBQUNYLE1BQU1ZLGdCQUFnQixPQUFPdEM7SUFDbEMsTUFBTVksUUFBUXRCLHdEQUFRLENBQUM7UUFBRVU7SUFBTyxHQUFHSCxZQUFZO1FBQUVLLFdBQVc7SUFBTTtJQUVsRSxNQUFNcUMsVUFBVSxNQUFNN0MsK0NBQU1BLENBQUM2QyxPQUFPLENBQUNDLE1BQU0sQ0FBQztRQUMxQ0MsTUFBTTtZQUNKekM7WUFDQVk7WUFDQThCLFdBQVcsSUFBSUMsS0FBS0EsS0FBS0MsR0FBRyxLQUFLLEtBQUssS0FBSyxLQUFLLEtBQUs7UUFDdkQ7SUFDRjtJQUVBLE9BQU9MO0FBQ1QsRUFBRTtBQUVGLDhCQUE4QjtBQUN2QixNQUFNTSxTQUFTLE9BQU9qQztJQUMzQixNQUFNbEIsK0NBQU1BLENBQUM2QyxPQUFPLENBQUNPLFVBQVUsQ0FBQztRQUM5QmxCLE9BQU87WUFDTGhCO1FBQ0Y7SUFDRjtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9saWNlbnNlLXN5c3RlbS8uL3V0aWxzL2F1dGgudHM/YjM4YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgand0LCB7IHZlcmlmeSB9IGZyb20gJ2pzb253ZWJ0b2tlbic7XG5pbXBvcnQgeyBjb21wYXJlLCBoYXNoIH0gZnJvbSAnYmNyeXB0JztcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4uL2xpYi9wcmlzbWEnO1xuaW1wb3J0IHsgR2V0U2VydmVyU2lkZVByb3BzQ29udGV4dCB9IGZyb20gJ25leHQnO1xuXG4vLyDEkOG6o20gYuG6o28gSldUX1NFQ1JFVCDEkcaw4bujYyBj4bqldSBow6xuaFxuaWYgKCFwcm9jZXNzLmVudi5KV1RfU0VDUkVUKSB7XG4gIHRocm93IG5ldyBFcnJvcignSldUX1NFQ1JFVCBpcyBub3QgY29uZmlndXJlZCBpbiBlbnZpcm9ubWVudCB2YXJpYWJsZXMnKTtcbn1cblxuY29uc3QgSldUX1NFQ1JFVCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQ7XG5cbi8vIEjDoG0gdOG6oW8gSldUIHRva2VuXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVUb2tlbiA9ICh1c2VySWQ6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIHJldHVybiBqd3Quc2lnbih7IHVzZXJJZCB9LCBKV1RfU0VDUkVULCB7IGV4cGlyZXNJbjogJzMwZCcgfSk7XG59O1xuXG4vLyBNw6MgaMOzYSBt4bqtdCBraOG6qXUgduG7m2kgYmNyeXB0XG5leHBvcnQgY29uc3QgaGFzaFBhc3N3b3JkID0gYXN5bmMgKHBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4gPT4ge1xuICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGhhc2gocGFzc3dvcmQsIDEwKTtcbiAgcmV0dXJuIGhhc2hlZFBhc3N3b3JkO1xufTtcblxuLy8gS2nhu4NtIHRyYSBt4bqtdCBraOG6qXVcbmV4cG9ydCBjb25zdCB2ZXJpZnlQYXNzd29yZCA9IGFzeW5jIChwbGFpblBhc3N3b3JkOiBzdHJpbmcsIGhhc2hlZFBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgY29tcGFyZShwbGFpblBhc3N3b3JkLCBoYXNoZWRQYXNzd29yZCk7XG4gICAgcmV0dXJuIGlzVmFsaWQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdmVyaWZ5aW5nIHBhc3N3b3JkOicsIGVycm9yKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbi8vIFjDoWMgdGjhu7FjIHRva2VuXG5leHBvcnQgY29uc3QgdmVyaWZ5VG9rZW4gPSBhc3luYyAodG9rZW46IHN0cmluZykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBKV1RfU0VDUkVUKTtcbiAgICByZXR1cm4gZGVjb2RlZDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdUb2tlbiB2ZXJpZmljYXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59O1xuXG4vLyBYw6FjIHRo4buxYyB1c2VyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXV0aGVudGljYXRlVXNlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICB0cnkge1xuICAgIC8vIFBhcnNlIGNvb2tpZXMgdOG7qyBoZWFkZXJcbiAgICBjb25zdCBjb29raWVzID0gcmVxLmhlYWRlcnMuY29va2llPy5zcGxpdCgnOycpLnJlZHVjZSgoYWNjOiBhbnksIGNvb2tpZTogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBba2V5LCB2YWx1ZV0gPSBjb29raWUudHJpbSgpLnNwbGl0KCc9Jyk7XG4gICAgICBhY2Nba2V5XSA9IHZhbHVlO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG5cbiAgICBjb25zdCB0b2tlbiA9IGNvb2tpZXM/LnRva2VuO1xuICAgIGlmICghdG9rZW4pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIFZlcmlmeSB0b2tlblxuICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnkodG9rZW4sIEpXVF9TRUNSRVQpIGFzIHsgdXNlcklkOiBzdHJpbmcgfTtcbiAgICBpZiAoIWRlY29kZWQgfHwgIWRlY29kZWQudXNlcklkKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBUw6xtIHVzZXIgdHJvbmcgZGF0YWJhc2VcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBpZDogZGVjb2RlZC51c2VySWQgfSxcbiAgICAgIHNlbGVjdDoge1xuICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgIHJvbGU6IHRydWUsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gdXNlcjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBdXRoZW50aWNhdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHJlcXVpcmVBdXRoID0gYXN5bmMgKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBhdXRoZW50aWNhdGVVc2VyKHJlcSwgcmVzKTtcbiAgXG4gIGlmICghdXNlcikge1xuICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIHVzZXI7XG59O1xuXG4vLyBNaWRkbGV3YXJlIGtp4buDbSB0cmEgcXV54buBbiBhZG1pblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVBZG1pbihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBjb25zdCB1c2VyID0gYXdhaXQgYXV0aGVudGljYXRlVXNlcihyZXEsIHJlcyk7XG4gIFxuICBpZiAoIXVzZXIpIHtcbiAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGlmICh1c2VyLnJvbGUgIT09ICdBRE1JTicpIHtcbiAgICByZXMuc3RhdHVzKDQwMykuanNvbih7IGVycm9yOiAnRm9yYmlkZGVuJyB9KTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiB1c2VyO1xufVxuXG4vLyBU4bqhbyBzZXNzaW9uIG3hu5tpXG5leHBvcnQgY29uc3QgY3JlYXRlU2Vzc2lvbiA9IGFzeW5jICh1c2VySWQ6IHN0cmluZykgPT4ge1xuICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKHsgdXNlcklkIH0sIEpXVF9TRUNSRVQsIHsgZXhwaXJlc0luOiAnMzBkJyB9KTtcbiAgXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5jcmVhdGUoe1xuICAgIGRhdGE6IHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHRva2VuLFxuICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKSxcbiAgICB9LFxuICB9KTtcbiAgXG4gIHJldHVybiBzZXNzaW9uO1xufTtcblxuLy8gSMOgbSDEkcSDbmcgeHXhuqV0ICh4w7NhIHNlc3Npb24pXG5leHBvcnQgY29uc3QgbG9nb3V0ID0gYXN5bmMgKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgYXdhaXQgcHJpc21hLnNlc3Npb24uZGVsZXRlTWFueSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHRva2VuXG4gICAgfVxuICB9KTtcbn07XG4iXSwibmFtZXMiOlsiand0IiwidmVyaWZ5IiwiY29tcGFyZSIsImhhc2giLCJwcmlzbWEiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsIkVycm9yIiwiZ2VuZXJhdGVUb2tlbiIsInVzZXJJZCIsInNpZ24iLCJleHBpcmVzSW4iLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsImhhc2hlZFBhc3N3b3JkIiwidmVyaWZ5UGFzc3dvcmQiLCJwbGFpblBhc3N3b3JkIiwiaXNWYWxpZCIsImVycm9yIiwiY29uc29sZSIsInZlcmlmeVRva2VuIiwidG9rZW4iLCJkZWNvZGVkIiwiYXV0aGVudGljYXRlVXNlciIsInJlcSIsInJlcyIsImNvb2tpZXMiLCJoZWFkZXJzIiwiY29va2llIiwic3BsaXQiLCJyZWR1Y2UiLCJhY2MiLCJrZXkiLCJ2YWx1ZSIsInRyaW0iLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiaWQiLCJzZWxlY3QiLCJlbWFpbCIsIm5hbWUiLCJyb2xlIiwicmVxdWlyZUF1dGgiLCJzdGF0dXMiLCJqc29uIiwicmVxdWlyZUFkbWluIiwiY3JlYXRlU2Vzc2lvbiIsInNlc3Npb24iLCJjcmVhdGUiLCJkYXRhIiwiZXhwaXJlc0F0IiwiRGF0ZSIsIm5vdyIsImxvZ291dCIsImRlbGV0ZU1hbnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./utils/auth.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/date-fns"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Flicenses&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Clicenses%5Cindex.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();